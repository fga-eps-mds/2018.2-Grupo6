<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Integração contínua · Integra Vendas</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;Integração contínua&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Integração contínua · Integra Vendas"/><meta property="og:type" content="website"/><meta property="og:url" content="https://fga-eps-mds.github.io/2018.2-Integra-Vendas//2018.2-Integra-Vendas/index.html"/><meta property="og:description" content="&lt;p&gt;Integração contínua&lt;/p&gt;
"/><meta property="og:image" content="https://fga-eps-mds.github.io/2018.2-Integra-Vendas//2018.2-Integra-Vendas/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://fga-eps-mds.github.io/2018.2-Integra-Vendas//2018.2-Integra-Vendas/img/docusaurus.png"/><link rel="shortcut icon" href="/2018.2-Integra-Vendas/undefined"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/2018.2-Integra-Vendas/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/2018.2-Integra-Vendas/"><h2 class="headerTitle">Integra Vendas</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/2018.2-Integra-Vendas/docs/tap" target="_self">Docs</a></li><li class=""><a href="/2018.2-Integra-Vendas/docs/sprint0" target="_self">Sprints</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Devops</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Abertura</h3><ul><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/tap">TAP</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/eap">EAP</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/canvas">Canvas</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/roi">ROI</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/evm">EVM</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Projeto</h3><ul><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/plano-metodologico">Plano Metodológico</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/doc-visao">Documento de Visão</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/doc-arquitetura">Documento de Arquitetura</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Métricas</h3><ul><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/riscos">Riscos</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/produtividade">Produtividade</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/conhecimento">Conhecimento</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Roadmaps</h3><ul><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/rm-geral">Roadmap Geral</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/rm-papeis">Roadmap dos papéis</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/rm-produto">Roadmap do Produto</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Design</h3><ul><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/id-visual">Identidade Visual</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/baixa-fidelidade">Baixa Fidelidade</a></li><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/alta-fidelidade">Alta Fidelidade</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Devops</h3><ul><li class="navListItem"><a class="navItem" href="/2018.2-Integra-Vendas/docs/devops-ambiente">Configuração de ambiente</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/2018.2-Integra-Vendas/docs/devops-cicd">Integração contínua</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Integração contínua</h1></header><article><div><span><p>Integração contínua</p>
<h1><a class="anchor" aria-hidden="true" id="travisci"></a><a href="#travisci" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TravisCI</h1>
<p>O Travis basicamente é uma ferramenta de execução de scripts em ambientes controlados. Esses scripts são acionados a partir de um push ou pull request realizado no repositório. Travis é capaz de perceber isso a partir da integração com o github que emite webhooks baseado em eventos no repositório.</p>
<p>Tendo o poder de executar scripts de acordo com eventos, pode-se realizar a suite de testes no momento do pull request e garantir que todos os testes estão passando como esperado. Pode-se executar builds de executáveis, realizar deploy da aplicação, etc.</p>
<p>Como o travis também te permite controlar o ambiente em que são executados os scripts, adicionando dependências, selecionando sistema operacional que executará o script, defindo variáveis de ambiente. É possível realizar testes em diferentes plataformas, realizar o deploy em diferentes ambientes, etc.</p>
<p>O gitlabci funciona assim como o travisci. Porém, dispõe de uma UI mais amigável.</p>
<h2><a class="anchor" aria-hidden="true" id="etapas"></a><a href="#etapas" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Etapas</h2>
<p>O travis permite o controle dos jobs sendo executados em stages. Um job é um ambiente separado que executará um script, podem haver vários jobs sendo executados em paralelo, os jobs estão dentro de uma build, que é o controle geral do travis para quando o travis é acionado.</p>
<p>Stages tornam possível a execução ordenada dos jobs. Em um stage podem ocorrer jobs paralelos, porém só se passa para o próximo stage quando todos os scripts forem executados e tiverem passado.</p>
<h2><a class="anchor" aria-hidden="true" id="atualmente-em-integra-vendas"></a><a href="#atualmente-em-integra-vendas" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Atualmente em Integra-Vendas</h2>
<p>Atualmente o CI está separado nas etapas:</p>
<ul>
<li>Teste</li>
<li>Build e publicação da imagem docker versionada no docker hub</li>
<li>Deploy</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="etapa-de-teste"></a><a href="#etapa-de-teste" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Etapa de Teste</h3>
<p>Na etapa de testes são executados:</p>
<ul>
<li>Testes unitários</li>
<li>Checagem do container de desenvolvimento</li>
<li>Checagem do container de produção</li>
<li>Publicação do relatório de testes no codecov</li>
</ul>
<p>Essa etapa é a mais importante quando se trata de integração contínua, é nela que se garante que o código que o desenvolvedor sobe para o repositório está estável, ou seja, não quebrou outras funcionalidades.</p>
<h3><a class="anchor" aria-hidden="true" id="etapa-de-build-e-publish"></a><a href="#etapa-de-build-e-publish" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Etapa de Build e Publish</h3>
<p>Na etapa de build e publicação do docker é executado apenas um script que realiza todo o procedimento. Esse script é responsável por realizar a build da imagem e publicá-la com a versão correta no dockerhub. O padrão atual de versionamento da imagem é:</p>
<ul>
<li>prefixo: integravendas</li>
<li>nome: nome do serviço</li>
<li>versão
<ul>
<li>desenvolvimento: latest</li>
<li>produção: latest-stable</li>
<li>produção versionada: stable-1.0</li>
</ul></li>
</ul>
<p>Ex.: integravendas/product-microservice:stable-1.0</p>
<h3><a class="anchor" aria-hidden="true" id="etapa-de-deploy"></a><a href="#etapa-de-deploy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Etapa de Deploy</h3>
<p>Na etapa de deploy, ocorre uma diversidade maior porque depende da plataforma a qual se esta subindo a aplicação. No caso do kubernetes é necessário realizar um procedimento na Engine de rolout e atualização da imagem utilizada, no caso do heroku é realizar um push específico.</p>
<ul>
<li>produção: Kubernetes</li>
<li>homologação: Heroku</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="qa"></a><a href="#qa" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>QA</h3>
<p>Quality Assurance, a fim de manter a qualidade do projeto. É realizada de duas formas:</p>
<ul>
<li>Cobertura de Testes</li>
</ul>
<p>Cobertura de testes com os testes unitários em django. Cobertura deve estar sempre acima de 80%.</p>
<ul>
<li>Análise estática</li>
</ul>
<p>Análise estática utilizando codeclimate. Codeclimate gera uma nota referente aos débitos técnicos causados por código pobre. Nosso padrão é sempre manter nota A.</p>
<h3><a class="anchor" aria-hidden="true" id="testes-unitarios-integrados"></a><a href="#testes-unitarios-integrados" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Testes Unitários Integrados</h3>
<p>No projeto integra-vendas temos um serviço chamado api-gateway. Ele é responsável por unificar a entrada de requisições e realizar a autenticação necessária.</p>
<p>Para que as suas funcionalidades fossem testadas nós elaboramos uma forma alternativa de testes unitários, que se mostrou como teste de integração do backend. Antes de realizar os testes unitários da api-gateway, se prepara um ambiente único e fechado de containers rodando os microserviços do sistema, após todos os microserviços estiverem executando, os testes são executados na api-gateway. Esses testes são necessários para ser gerado o relatório de cobertura de testes da api-gateway.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/2018.2-Integra-Vendas/docs/devops-ambiente"><span class="arrow-prev">← </span><span>Configuração de Ambiente</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#etapas">Etapas</a></li><li><a href="#atualmente-em-integra-vendas">Atualmente em Integra-Vendas</a><ul class="toc-headings"><li><a href="#etapa-de-teste">Etapa de Teste</a></li><li><a href="#etapa-de-build-e-publish">Etapa de Build e Publish</a></li><li><a href="#etapa-de-deploy">Etapa de Deploy</a></li><li><a href="#qa">QA</a></li><li><a href="#testes-unitarios-integrados">Testes Unitários Integrados</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/2018.2-Integra-Vendas/" class="nav-home"></a><div><h5>Docs</h5><a href="/2018.2-Integra-Vendas/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/2018.2-Integra-Vendas/docs/en/doc2.html">Guides (or other categories)</a><a href="/2018.2-Integra-Vendas/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/2018.2-Integra-Vendas/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/2018.2-Integra-Vendas/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/2018.2-Integra-Vendas/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2018 Integra Vendas</section></footer></div></body></html>